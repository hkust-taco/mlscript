<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="index.css">
    <title>MLscript demonstration</title>
  </head>
  <body>
  <h1>MLscript demonstration</h1>
  <div id="content">
    <textarea id="mlscript-input" class="panel" spellcheck="false">
class Left[A]: { value: A }
def Left value = Left{ value }

class Right[A]: { value: A }
def Right value = Right{ value }

def testVal = if true then Left 1 else Right 2
def res = case testVal of
  { Left -> testVal.value
  | Right -> 1
  }

def zero = 0
def bruh = "Bruh"
def two = add 1 zero
def lambda = fun x -> x
def simpleLet = let i = 0 in add i 1

def f: (int & 'a) -> (int & 'a) -> 'a
def f a b = if gt a b then a else b

f 1 2

def test x = case x of
  { Left -> x.value
  | Right -> "nope"
  }

def tmp = test (if true then Left 1 else Right 2)

case tmp of { int -> tmp | string -> 0 }

def test2 x = case x of
  { int -> x
  | bool -> x
  | string -> x
  }
test2 1
test2 true
test2 "a"

def test3 x = case x of
  { 1 -> true
  | true -> true
  | "a" -> true
  | _ -> false
  }
test3 1
test3 true
test3 "a"
test3 2
test3 false
test3 "oops"
test3 {}
    </textarea>
<!-- let rec recursive_monster = fun x ->
  { thing = x;
    self = recursive_monster x } -->
    <div id="mlscript-output" class="panel"></div>
  </div>
  <script type="text/javascript" src="js/target/scala-2.13/mlscript-fastopt/main.js"></script>
  <br/>
  <p>The code is available <a href="https://github.com/LPTK/mlscript">on github</a>.</p>
  <br/>
  <p>Credit: the CSS style sheet of this page was shamelessly stolen from <a href="https://www.cl.cam.ac.uk/~sd601/mlsub/">the MLsub demo page</a>.</p>
</html>
