:NewDefs

class Some[out T](value: T)
class Left[out T](value: T)
class Right[out T](value: T)
//│ class Some[T](value: T)
//│ class Left[T](value: T)
//│ class Right[T](value: T)

// FIXME unhygienic, the `x` in the second branch shadows parameter `x`
fun foo(x) = if x is
  Some(Left(y)) then x
  Some(x) then x
//│ fun foo: forall 'T. Some['T & (Left[anything] | Object & ~#Left | ~??T)] -> (??T & 'T)

foo(Some(Left(1)))
//│ Left[1] & ??T
//│ res
//│     = Left {}

foo(Some(2))
//│ 2 & ??T
//│ res
//│     = 2
