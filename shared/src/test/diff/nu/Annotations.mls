:NewDefs


@tailrec fun foo(n) =
  if n > 0 then
    log(join of "hi ", String(n))
    foo(n - 1)
  else ()
//│ fun foo: Int -> ()

foo(5)
//│ ()
//│ res
//│     = undefined
//│ // Output
//│ hi 5
//│ hi 4
//│ hi 3
//│ hi 2
//│ hi 1


// TODO
fun foo(n) =
  if n > 0 then
    log(join of "hi ", String(n))
    foo(div of n,  2)
    @tailrec foo(n - 1)
  else ()
//│ fun foo: Int -> ()
//│ Code generation encountered an error:
//│   cannot generate code for term Ann(Annotation(Var(tailrec)),App(Var(foo),Tup(List((None,Fld(_,App(Var(-),Tup(List((None,Fld(_,Var(n))), (None,Fld(_,IntLit(1))))))))))))

// TODO
foo(5)
//│ ()
//│ res
//│ Runtime error:
//│   ReferenceError: foo1 is not defined



// TODO: Tail recursion modulo cons
// fun foo(n) =
//   ...
//   Cons(a, foo(n - 1))
// ———>
// fun foo(n) =
//   ...
//   foo(n - 1, Cons(a, .))


