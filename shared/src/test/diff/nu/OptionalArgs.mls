:NewDefs


// TODO: there is problem when the is SPACE after '?'

:dp
fun f1(a?: Int, b?: Int) = a + b
//│ |#fun| |f1|(|a|?|#:| |Int|,| |b|?|#:| |Int|)| |#=| |a| |+| |b|
//│ At MM
//│ ? block		inspects |#fun| |f1|(|a|?|#:| |Int|,| |b|?|#:| |Int|)| |...    [at l.301]
//│ ? go		inspects |#fun| |f1|(|a|?|#:| |Int|,| |b|?|#:| |Int|)| |...    [at l.270]
//│ ? go		inspects |#fun| |f1|(|a|?|#:| |Int|,| |b|?|#:| |Int|)| |...    [at l.270]
//│ At MM2
//│ ! t		consumes |#fun|    [at l.416]
//│ ? yeetSpaces		inspects | |f1|(|a|?|#:| |Int|,| |b|?|#:| |Int|)| |#=|...    [at l.527]
//│ ! yeetSpaces		consumes | |    [at l.527]
//│ ? yeetSpaces		inspects |f1|(|a|?|#:| |Int|,| |b|?|#:| |Int|)| |#=| |...    [at l.527]
//│ ! x$29		consumes |f1|    [at l.427]
//│ foundErr => false true
//│ ? yeetSpaces		inspects |(|a|?|#:| |Int|,| |b|?|#:| |Int|)| |#=| |a|...    [at l.527]
//│ HERE1
//│ ? yeetSpaces		inspects |(|a|?|#:| |Int|,| |b|?|#:| |Int|)| |#=| |a|...    [at l.527]
//│ @ funParams(())    [at l.469]
//│ │ ? yeetSpaces		inspects |(|a|?|#:| |Int|,| |b|?|#:| |Int|)| |#=| |a|...    [at l.527]
//│ │ ! res		consumes |(|a|?|#:| |Int|,| |b|?|#:| |Int|)|    [at l.538]
//│ │ > ? maybeIndented		inspects |a|?|#:| |Int|...    [at l.1013]
//│ │ > @ argsOrIf(List(),List())    [at l.1056]
//│ │ > │ ? argsOrIf		inspects |a|?|#:| |Int|...    [at l.1057]
//│ │ > │ ? yeetSpaces		inspects |a|?|#:| |Int|...    [at l.527]
//│ │ > │ ? yeetSpaces		inspects |a|?|#:| |Int|...    [at l.527]
//│ │ > │ ? yeetSpaces		inspects |a|?|#:| |Int|...    [at l.527]
//│ │ > │ good! (IDENT(a,false),Loc(7,8,nu/OptionalArgs:+7)) (IDENT(?,true),Loc(8,8,nu/OptionalArgs:+7)) (KEYWORD(:),Loc(9,10,nu/OptionalArgs:+7))
//│ │ > │ ? yeetSpaces		inspects |a|?|#:| |Int|...    [at l.527]
//│ │ > │ ! x$60		consumes |a|    [at l.1095]
//│ │ > │ ! x$60		consumes |?|    [at l.1096]
//│ │ > │ ! x$60		consumes |#:|    [at l.1097]
//│ │ > │ case #3
//│ │ > │ flags => None None Some(Loc(8,8,nu/OptionalArgs:+7))
//│ │ > │ @ exprOrIf(1,true)    [at l.1109]
//│ │ > │ │ ? exprOrIf		inspects | |Int|,| |b|...    [at l.571]
//│ │ > │ │ ! exprOrIf		consumes | |    [at l.573]
//│ │ > │ │ @ exprOrIf(1,true)    [at l.574]
//│ │ > │ │ │ ? exprOrIf		inspects |Int|,| |b|?|...    [at l.571]
//│ │ > │ │ │ ! exprOrIf		consumes |Int|    [at l.590]
//│ │ > │ │ │ @ exprCont(1,`Int`,false)    [at l.591]
//│ │ > │ │ │ │ ? exprCont		inspects |,| |b|?|#:|...    [at l.747]
//│ │ > │ │ │ = Right(Int)
//│ │ > │ │ = Right(Int)
//│ │ > │ = Right(Int)
//│ │ > │ ? argsOrIf		inspects |,| |b|?|#:|...    [at l.1117]
//│ │ > │ ! argsOrIf		consumes |,|    [at l.1123]
//│ │ > │ @ argsOrIf(List((Some(a),Right(Fld(FldFlags(false,false,true),Int)))),List())    [at l.1056]
//│ │ > │ │ ? argsOrIf		inspects | |b|?|#:| |...    [at l.1057]
//│ │ > │ │ ! argsOrIf		consumes | |    [at l.1066]
//│ │ > │ │ @ argsOrIf(List((Some(a),Right(Fld(FldFlags(false,false,true),Int)))),List())    [at l.1056]
//│ │ > │ │ │ ? argsOrIf		inspects |b|?|#:| |Int|    [at l.1057]
//│ │ > │ │ │ ? yeetSpaces		inspects |b|?|#:| |Int|    [at l.527]
//│ │ > │ │ │ ? yeetSpaces		inspects |b|?|#:| |Int|    [at l.527]
//│ │ > │ │ │ ? yeetSpaces		inspects |b|?|#:| |Int|    [at l.527]
//│ │ > │ │ │ good! (IDENT(b,false),Loc(16,17,nu/OptionalArgs:+7)) (IDENT(?,true),Loc(17,17,nu/OptionalArgs:+7)) (KEYWORD(:),Loc(18,19,nu/OptionalArgs:+7))
//│ │ > │ │ │ ? yeetSpaces		inspects |b|?|#:| |Int|    [at l.527]
//│ │ > │ │ │ ! x$60		consumes |b|    [at l.1095]
//│ │ > │ │ │ ! x$60		consumes |?|    [at l.1096]
//│ │ > │ │ │ ! x$60		consumes |#:|    [at l.1097]
//│ │ > │ │ │ case #3
//│ │ > │ │ │ flags => None None Some(Loc(17,17,nu/OptionalArgs:+7))
//│ │ > │ │ │ @ exprOrIf(1,true)    [at l.1109]
//│ │ > │ │ │ │ ? exprOrIf		inspects | |Int|    [at l.571]
//│ │ > │ │ │ │ ! exprOrIf		consumes | |    [at l.573]
//│ │ > │ │ │ │ @ exprOrIf(1,true)    [at l.574]
//│ │ > │ │ │ │ │ ? exprOrIf		inspects |Int|    [at l.571]
//│ │ > │ │ │ │ │ ! exprOrIf		consumes |Int|    [at l.590]
//│ │ > │ │ │ │ │ @ exprCont(1,`Int`,false)    [at l.591]
//│ │ > │ │ │ │ │ │ ? exprCont		inspects ||    [at l.747]
//│ │ > │ │ │ │ │ = Right(Int)
//│ │ > │ │ │ │ = Right(Int)
//│ │ > │ │ │ = Right(Int)
//│ │ > │ │ │ ? argsOrIf		inspects ||    [at l.1117]
//│ │ > │ │ = List((Some(a),Right(Fld(FldFlags(false,false,true),Int))), (Some(b),Right(Fld(FldFlags(false,false,true),Int))))
//│ │ > │ = List((Some(a),Right(Fld(FldFlags(false,false,true),Int))), (Some(b),Right(Fld(FldFlags(false,false,true),Int))))
//│ │ > = List((Some(a),Right(Fld(FldFlags(false,false,true),Int))), (Some(b),Right(Fld(FldFlags(false,false,true),Int))))
//│ │ > ? concludeWith		inspects ||    [at l.86]
//│ │ > Concluded with List((Some(a),Fld(FldFlags(false,false,true),Int)), (Some(b),Fld(FldFlags(false,false,true),Int)))
//│ │ Okkkkk as => List((Some(a),Fld(FldFlags(false,false,true),Int)), (Some(b),Fld(FldFlags(false,false,true),Int)))
//│ │ @ funParams(())    [at l.541]
//│ │ │ ? yeetSpaces		inspects | |#=| |a| |...    [at l.527]
//│ │ │ ! yeetSpaces		consumes | |    [at l.527]
//│ │ │ Here, creating the params! List()
//│ │ = List()
//│ │ Here, creating the params! List(a: Int, b: Int,) Tup(a: Var(Int), b: Var(Int))
//│ = List(a: Int, b: Int,)
//│ head => List((Some(a),Fld(FldFlags(false,false,true),Int)), (Some(b),Fld(FldFlags(false,false,true),Int)))
//│ case 2List(a: Int, b: Int,)
//│ ps and transformBody => List(a: Int, b: Int,) None
//│ ? yeetSpaces		inspects |#=| |a| |+|...    [at l.527]
//│ ? yeetSpaces		inspects |#=| |a| |+|...    [at l.527]
//│ ! t		consumes |#=|    [at l.487]
//│ @ expr(0,true)    [at l.488]
//│ │ @ exprOrIf(0,true)    [at l.559]
//│ │ │ ? exprOrIf		inspects | |a| |+| |...    [at l.571]
//│ │ │ ! exprOrIf		consumes | |    [at l.573]
//│ │ │ @ exprOrIf(0,true)    [at l.574]
//│ │ │ │ ? exprOrIf		inspects |a| |+| |b|    [at l.571]
//│ │ │ │ ! exprOrIf		consumes |a|    [at l.590]
//│ │ │ │ @ exprCont(0,`a`,false)    [at l.591]
//│ │ │ │ │ ? exprCont		inspects | |+| |b|    [at l.747]
//│ │ │ │ │ ! exprCont		consumes | |    [at l.791]
//│ │ │ │ │ @ exprCont(0,`a`,false)    [at l.792]
//│ │ │ │ │ │ ? exprCont		inspects |+| |b|    [at l.747]
//│ │ │ │ │ │ ! exprCont		consumes |+|    [at l.756]
//│ │ │ │ │ │ @ exprOrIf(18,true)    [at l.759]
//│ │ │ │ │ │ │ ? exprOrIf		inspects | |b|    [at l.571]
//│ │ │ │ │ │ │ ! exprOrIf		consumes | |    [at l.573]
//│ │ │ │ │ │ │ @ exprOrIf(18,true)    [at l.574]
//│ │ │ │ │ │ │ │ ? exprOrIf		inspects |b|    [at l.571]
//│ │ │ │ │ │ │ │ ! exprOrIf		consumes |b|    [at l.590]
//│ │ │ │ │ │ │ │ @ exprCont(18,`b`,false)    [at l.591]
//│ │ │ │ │ │ │ │ │ ? exprCont		inspects ||    [at l.747]
//│ │ │ │ │ │ │ │ = Right(b)
//│ │ │ │ │ │ │ = Right(b)
//│ │ │ │ │ │ = Right(b)
//│ │ │ │ │ │ @ exprCont(0,`+ (a,) (b,)`,false)    [at l.763]
//│ │ │ │ │ │ │ ? exprCont		inspects ||    [at l.747]
//│ │ │ │ │ │ = Right(+ (a,) (b,))
//│ │ │ │ │ = Right(+ (a,) (b,))
//│ │ │ │ = Right(+ (a,) (b,))
//│ │ │ = Right(+ (a,) (b,))
//│ │ = Right(+ (a,) (b,))
//│ = + (a,) (b,)
//│ ? yeetSpaces		inspects ||    [at l.527]
//│ ? parseAll		inspects ||    [at l.75]
//│ Parsed: fun f1 = (a: Int, b: Int,) => + (a,) (b,);
//│ fun f1: (a: Int, b: Int,) -> Int


// using space, creates ASC in AST.
:p
fun f1(a: Int, b: Int) = a + b
//│ |#fun| |f1|(|a|#:| |Int|,| |b|#:| |Int|)| |#=| |a| |+| |b|
//│ AST: TypingUnit(NuFunDef(None, f1, [], Lam(Tup(a: Var(Int), b: Var(Int)), App(App(Var(+), Tup(_: Var(a))), Tup(_: Var(b))))))
//│ Parsed: fun f1 = (a: Int, b: Int,) => + (a,) (b,);
//│ fun f1: (a: Int, b: Int,) -> Int

f1(1, 2)
//│ Int
//│ res
//│     = 3

:p
fun f1(a, b) = a + b
//│ |#fun| |f1|(|a|,| |b|)| |#=| |a| |+| |b|
//│ AST: TypingUnit(NuFunDef(None, f1, [], Lam(Tup(_: Var(a), _: Var(b)), App(App(Var(+), Tup(_: Var(a))), Tup(_: Var(b))))))
//│ Parsed: fun f1 = (a, b,) => + (a,) (b,);
//│ fun f1: (Int, Int,) -> Int


:p
f1(1, 2)
//│ |f1|(|1|,| |2|)|
//│ AST: TypingUnit(App(Var(f1), Tup(_: IntLit(1), _: IntLit(2))))
//│ Parsed: f1 (1, 2,);
//│ Int
//│ res
//│     = 3
